{"ast":null,"code":"import { defineComponent } from 'vue';\nimport registerMixin from '../../../mixins/register-component.mjs';\nimport editorMixin from '../../../mixins/editor-component.mjs';\nimport { isMapInstance, isOverlayGroupInstance, isVectorLayerInstance } from '../../../utils/util.mjs';\nimport { toLngLat } from '../../../utils/convert-helper.mjs';\nvar script = defineComponent({\n  name: \"ElAmapRectangle\",\n  mixins: [registerMixin, editorMixin],\n  props: {\n    bounds: {\n      type: Array,\n      required: true\n    },\n    bubble: {\n      type: Boolean,\n      default: false\n    },\n    cursor: {\n      type: String\n    },\n    strokeColor: {\n      type: String\n    },\n    strokeOpacity: {\n      type: Number\n    },\n    strokeWeight: {\n      type: Number\n    },\n    fillColor: {\n      type: String\n    },\n    fillOpacity: {\n      type: Number\n    },\n    draggable: {\n      type: Boolean,\n      default: false\n    },\n    extData: {\n      type: Object,\n      default: () => null\n    },\n    strokeStyle: {\n      type: String,\n      validator(value) {\n        return [\"solid\", \"dashed\"].indexOf(value) !== -1;\n      }\n    },\n    strokeDasharray: {\n      type: Array\n    }\n  },\n  emits: [\"update:bounds\"],\n  data() {\n    return {\n      converters: {\n        bounds(path) {\n          return new AMap.Bounds(toLngLat(path[0]), toLngLat(path[1]));\n        }\n      }\n    };\n  },\n  methods: {\n    __initComponent(options) {\n      this.$amapComponent = new AMap.Rectangle(options);\n      if (isMapInstance(this.$parentComponent)) {\n        this.$parentComponent.add(this.$amapComponent);\n      } else if (isOverlayGroupInstance(this.$parentComponent)) {\n        this.$parentComponent.addOverlay(this.$amapComponent);\n      } else if (isVectorLayerInstance(this.$parentComponent)) {\n        this.$parentComponent.add(this.$amapComponent);\n      }\n      this.bindModelEvents();\n    },\n    bindModelEvents() {\n      this.$amapComponent.on(\"dragend\", () => {\n        this.emitModel(this.$amapComponent);\n      });\n      this.$amapComponent.on(\"touchend\", () => {\n        this.emitModel(this.$amapComponent);\n      });\n    },\n    createEditor() {\n      return new Promise(resolve => {\n        if (this.$amapComponent.editor) {\n          resolve();\n        } else {\n          AMap.plugin([\"AMap.RectangleEditor\"], () => {\n            this.$amapComponent.editor = new AMap.RectangleEditor(this.$parentComponent, this.$amapComponent, this.editOptions);\n            this.setEditorEvents();\n            this.bindEditorModelEvents();\n            resolve();\n          });\n        }\n      });\n    },\n    bindEditorModelEvents() {\n      this.$amapComponent.editor.on(\"addnode\", e => {\n        this.emitModel(e.target);\n      });\n      this.$amapComponent.editor.on(\"adjust\", e => {\n        this.emitModel(e.target);\n      });\n      this.$amapComponent.editor.on(\"move\", e => {\n        this.emitModel(e.target);\n      });\n      this.$amapComponent.editor.on(\"add\", e => {\n        this.emitModel(e.target);\n      });\n      this.$amapComponent.editor.on(\"end\", e => {\n        this.emitModel(e.target);\n      });\n    },\n    emitModel(target) {\n      const bounds = target.getBounds();\n      const southWest = bounds.getSouthWest();\n      const northEast = bounds.getNorthEast();\n      const paths = [southWest.toArray(), northEast.toArray()];\n      this.$emit(\"update:bounds\", paths);\n    },\n    destroyComponent() {\n      if (this.$amapComponent.editor) {\n        if (!this.parentInstance.isDestroy) {\n          this.$amapComponent.editor.close();\n        }\n        this.$amapComponent.editor = null;\n      }\n      if (!this.parentInstance.isDestroy) {\n        if (isMapInstance(this.$parentComponent)) {\n          this.$parentComponent.remove(this.$amapComponent);\n        } else if (isOverlayGroupInstance(this.$parentComponent)) {\n          this.$parentComponent.removeOverlay(this.$amapComponent);\n        } else if (isVectorLayerInstance(this.$parentComponent)) {\n          this.$parentComponent.remove(this.$amapComponent);\n        }\n      }\n      if (this.$amapComponent.destroy) {\n        this.$amapComponent.destroy();\n      }\n      this.$amapComponent = null;\n      this.$parentComponent = null;\n    },\n    __zIndex(value) {\n      if (this.$amapComponent) {\n        this.$amapComponent.setOptions({\n          zIndex: value\n        });\n      }\n    },\n    __strokeColor(value) {\n      if (this.$amapComponent) {\n        this.$amapComponent.setOptions({\n          strokeColor: value\n        });\n      }\n    },\n    __strokeOpacity(value) {\n      if (this.$amapComponent) {\n        this.$amapComponent.setOptions({\n          strokeOpacity: value\n        });\n      }\n    },\n    __strokeWeight(value) {\n      if (this.$amapComponent) {\n        this.$amapComponent.setOptions({\n          strokeWeight: value\n        });\n      }\n    },\n    __fillColor(value) {\n      if (this.$amapComponent) {\n        this.$amapComponent.setOptions({\n          fillColor: value\n        });\n      }\n    },\n    __fillOpacity(value) {\n      if (this.$amapComponent) {\n        this.$amapComponent.setOptions({\n          fillOpacity: value\n        });\n      }\n    },\n    __strokeStyle(value) {\n      if (this.$amapComponent) {\n        this.$amapComponent.setOptions({\n          strokeStyle: value\n        });\n      }\n    },\n    __strokeDasharray(value) {\n      if (this.$amapComponent) {\n        this.$amapComponent.setOptions({\n          strokeDasharray: value\n        });\n      }\n    },\n    __editable(flag) {\n      this.createEditor().then(() => {\n        flag === true ? this.$amapComponent.editor.open() : this.$amapComponent.editor.close();\n      });\n    }\n  },\n  render() {\n    return null;\n  }\n});\nexport { script as default };","map":{"version":3,"mappings":"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","names":["defineComponent","name","mixins","registerMixin","props","bounds","type","required","bubble","default","cursor","strokeColor","strokeOpacity","strokeWeight","fillColor","fillOpacity","draggable","extData","strokeStyle","validator","value","strokeDasharray","emits","data","converters","path","AMap","toLngLat","methods","__initComponent","options","Rectangle","$parentComponent","add","addOverlay","bindModelEvents","on","emitModel","createEditor","Promise","resolve","$amapComponent","editor","RectangleEditor","bindEditorModelEvents","e","target","southWest","northEast","paths","$emit","destroyComponent","isDestroy","remove","removeOverlay","destroy","__zIndex","setOptions","zIndex","__strokeColor","__strokeOpacity","__strokeWeight","__fillColor","__fillOpacity","__strokeStyle","__strokeDasharray","__editable","flag","then","open","render"],"sources":["../../../../../../src/packages/vector/Rectangle/Rectangle.vue"],"sourcesContent":["<script lang=\"ts\">\r\nimport {defineComponent} from \"vue\";\r\nimport registerMixin from '../../../mixins/register-component';\r\nimport editorMixin from '../../../mixins/editor-component';\r\nimport {isMapInstance, isOverlayGroupInstance, isVectorLayerInstance} from '../../../utils/util';\r\nimport {toLngLat} from '../../../utils/convert-helper';\r\n\r\nexport default defineComponent({\r\n  name: 'ElAmapRectangle',\r\n  mixins: [registerMixin, editorMixin],\r\n  props: {\r\n    bounds: {\r\n      type: Array,\r\n      required: true\r\n    }, // 矩形的范围\r\n    bubble: {\r\n      type: Boolean,\r\n      default: false\r\n    }, // 是否将覆盖物的鼠标或touch等事件冒泡到地图上\r\n    cursor: {\r\n      type: String\r\n    }, // 指定鼠标悬停时的鼠标样式，自定义cursor，IE仅支持cur/ani/ico格式，Opera不支持自定义cursor\r\n    strokeColor: {\r\n      type: String\r\n    }, // 线条颜色，使用16进制颜色代码赋值。默认值为#00D3FC\r\n    strokeOpacity: {\r\n      type: Number\r\n    }, // 轮廓线透明度，取值范围 [0,1] ，0表示完全透明，1表示不透明。默认为0.9\r\n    strokeWeight: {\r\n      type: Number\r\n    }, // 轮廓线宽度。默认 2\r\n    fillColor: {\r\n      type: String\r\n    }, // 多边形填充颜色，使用16进制颜色代码赋值，如：#00B2D5\r\n    fillOpacity: {\r\n      type: Number\r\n    }, // 多边形填充透明度，取值范围 [0,1] ，0表示完全透明，1表示不透明。默认为0.5\r\n    draggable: {\r\n      type: Boolean,\r\n      default: false\r\n    }, // 设置多边形是否可拖拽移动，默认为false\r\n    extData: {\r\n      type: Object,\r\n      default: () => null\r\n    },\r\n    strokeStyle: {\r\n      type: String,\r\n      validator(value : string) {\r\n        // 这个值必须匹配下列字符串中的一个\r\n        return ['solid', 'dashed'].indexOf(value) !== -1;\r\n      }\r\n    }, // 轮廓线样式，实线:solid，虚线:dashed\r\n    strokeDasharray: {\r\n      type: Array\r\n    }// 勾勒形状轮廓的虚线和间隙的样式，此属性在strokeStyle 为dashed 时有效， 此属性在ie9+浏览器有效 取值： 实线： [0,0,0] 虚线： [10,10] ， [10,10] 表示10个像素的实线和10个像素的空白（如此反复）组成的虚线 点画线： [10,2,10] ， [10,2,10] 表示10个像素的实线和2个像素的空白 + 10个像素的实线和10个像素的空白 （如此反复）组成的虚线\r\n  },\r\n  emits: ['update:bounds'],\r\n  data() {\r\n    return {\r\n      converters: {\r\n        bounds(path) {\r\n          return new AMap.Bounds(toLngLat(path[0]), toLngLat(path[1]));\r\n        }\r\n      },\r\n    };\r\n  },\r\n  methods: {\r\n    __initComponent(options) {\r\n      this.$amapComponent = new AMap.Rectangle(options);\r\n      if (isMapInstance(this.$parentComponent)) {\r\n        this.$parentComponent.add(this.$amapComponent);\r\n      } else if (isOverlayGroupInstance(this.$parentComponent)) {\r\n        this.$parentComponent.addOverlay(this.$amapComponent);\r\n      } else if (isVectorLayerInstance(this.$parentComponent)) {\r\n        this.$parentComponent.add(this.$amapComponent);\r\n      }\r\n      this.bindModelEvents();\r\n    },\r\n    bindModelEvents(){\r\n      this.$amapComponent.on('dragend',() => {\r\n        this.emitModel(this.$amapComponent);\r\n      });\r\n      this.$amapComponent.on('touchend',() => {\r\n        this.emitModel(this.$amapComponent);\r\n      });\r\n    },\r\n    createEditor() {\r\n      return new Promise<void>((resolve) => {\r\n        if (this.$amapComponent.editor) {\r\n          resolve();\r\n        } else {\r\n          AMap.plugin(['AMap.RectangleEditor'], () => {\r\n            this.$amapComponent.editor = new AMap.RectangleEditor(this.$parentComponent, this.$amapComponent, this.editOptions);\r\n            this.setEditorEvents();\r\n            this.bindEditorModelEvents();\r\n            resolve();\r\n          });\r\n        }\r\n      });\r\n    },\r\n    bindEditorModelEvents(){\r\n      this.$amapComponent.editor.on('addnode',(e) => {\r\n        this.emitModel(e.target);\r\n      });\r\n      this.$amapComponent.editor.on('adjust',(e) => {\r\n        this.emitModel(e.target);\r\n      });\r\n      this.$amapComponent.editor.on('move',(e) => {\r\n        this.emitModel(e.target);\r\n      });\r\n      this.$amapComponent.editor.on('add',(e) => {\r\n        this.emitModel(e.target);\r\n      });\r\n      this.$amapComponent.editor.on('end',(e) => {\r\n        this.emitModel(e.target);\r\n      });\r\n    },\r\n    emitModel(target){\r\n      const bounds = target.getBounds();\r\n      const southWest = bounds.getSouthWest();\r\n      const northEast = bounds.getNorthEast();\r\n      const paths = [southWest.toArray(), northEast.toArray()]\r\n      this.$emit('update:bounds', paths);\r\n    },\r\n    destroyComponent() {\r\n      if (this.$amapComponent.editor) {\r\n        if(!this.parentInstance.isDestroy){\r\n          this.$amapComponent.editor.close();\r\n        }\r\n        this.$amapComponent.editor = null;\r\n      }\r\n      if(!this.parentInstance.isDestroy){\r\n        if (isMapInstance(this.$parentComponent)) {\r\n          this.$parentComponent.remove(this.$amapComponent);\r\n        } else if (isOverlayGroupInstance(this.$parentComponent)) {\r\n          this.$parentComponent.removeOverlay(this.$amapComponent);\r\n        } else if (isVectorLayerInstance(this.$parentComponent)) {\r\n          this.$parentComponent.remove(this.$amapComponent);\r\n        }\r\n      }\r\n      if(this.$amapComponent.destroy){\r\n        this.$amapComponent.destroy();\r\n      }\r\n      this.$amapComponent = null;\r\n      this.$parentComponent = null;\r\n    },\r\n    __zIndex(value) {\r\n      if(this.$amapComponent){\r\n        this.$amapComponent.setOptions({zIndex: value});\r\n      }\r\n    },\r\n    __strokeColor(value) {\r\n      if(this.$amapComponent){\r\n        this.$amapComponent.setOptions({strokeColor: value});\r\n      }\r\n    },\r\n    __strokeOpacity(value) {\r\n      if(this.$amapComponent){\r\n        this.$amapComponent.setOptions({strokeOpacity: value});\r\n      }\r\n    },\r\n    __strokeWeight(value) {\r\n      if(this.$amapComponent){\r\n        this.$amapComponent.setOptions({strokeWeight: value});\r\n      }\r\n    },\r\n    __fillColor(value) {\r\n      if(this.$amapComponent){\r\n        this.$amapComponent.setOptions({fillColor: value});\r\n      }\r\n    },\r\n    __fillOpacity(value) {\r\n      if(this.$amapComponent){\r\n        this.$amapComponent.setOptions({fillOpacity: value});\r\n      }\r\n    },\r\n    __strokeStyle(value) {\r\n      if(this.$amapComponent){\r\n        this.$amapComponent.setOptions({strokeStyle: value});\r\n      }\r\n    },\r\n    __strokeDasharray(value) {\r\n      if(this.$amapComponent){\r\n        this.$amapComponent.setOptions({strokeDasharray: value});\r\n      }\r\n    },\r\n    __editable(flag) {\r\n      this.createEditor().then(() => {\r\n        flag === true ? this.$amapComponent.editor.open() : this.$amapComponent.editor.close();\r\n      });\r\n    },\r\n  },\r\n  render(){\r\n    return null;\r\n  }\r\n});\r\n</script>\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}