{"ast":null,"code":"const getHtmlElementFromNode = ({\n  el\n}) => el;\nconst addContext = (domElement, context) => domElement.__draggable_context = context;\nconst getContext = domElement => domElement.__draggable_context;\nclass ComponentStructure {\n  constructor({\n    nodes: {\n      header,\n      default: defaultNodes,\n      footer\n    },\n    root,\n    realList\n  }) {\n    this.defaultNodes = defaultNodes;\n    this.children = [...header, ...defaultNodes, ...footer];\n    this.externalComponent = root.externalComponent;\n    this.rootTransition = root.transition;\n    this.tag = root.tag;\n    this.realList = realList;\n  }\n  get _isRootComponent() {\n    return this.externalComponent || this.rootTransition;\n  }\n  render(h, attributes) {\n    const {\n      tag,\n      children,\n      _isRootComponent\n    } = this;\n    const option = !_isRootComponent ? children : {\n      default: () => children\n    };\n    return h(tag, attributes, option);\n  }\n  updated() {\n    const {\n      defaultNodes,\n      realList\n    } = this;\n    defaultNodes.forEach((node, index) => {\n      addContext(getHtmlElementFromNode(node), {\n        element: realList[index],\n        index\n      });\n    });\n  }\n  getUnderlyingVm(domElement) {\n    return getContext(domElement);\n  }\n  getVmIndexFromDomIndex(domIndex, element) {\n    const {\n      defaultNodes\n    } = this;\n    const {\n      length\n    } = defaultNodes;\n    const domChildren = element.children;\n    const domElement = domChildren.item(domIndex);\n    if (domElement === null) {\n      return length;\n    }\n    const context = getContext(domElement);\n    if (context) {\n      return context.index;\n    }\n    if (length === 0) {\n      return 0;\n    }\n    const firstDomListElement = getHtmlElementFromNode(defaultNodes[0]);\n    const indexFirstDomListElement = [...domChildren].findIndex(element => element === firstDomListElement);\n    return domIndex < indexFirstDomListElement ? 0 : length;\n  }\n}\nexport { ComponentStructure };","map":{"version":3,"names":["getHtmlElementFromNode","el","addContext","domElement","context","__draggable_context","getContext","ComponentStructure","constructor","nodes","header","default","defaultNodes","footer","root","realList","children","externalComponent","rootTransition","transition","tag","_isRootComponent","render","h","attributes","option","updated","forEach","node","index","element","getUnderlyingVm","getVmIndexFromDomIndex","domIndex","length","domChildren","item","firstDomListElement","indexFirstDomListElement","findIndex"],"sources":["/Users/yanbinru/Desktop/代码/github/vue3-knowledge/node_modules/vuedraggable/src/core/componentStructure.js"],"sourcesContent":["const getHtmlElementFromNode = ({ el }) => el;\r\nconst addContext = (domElement, context) =>\r\n  (domElement.__draggable_context = context);\r\nconst getContext = domElement => domElement.__draggable_context;\r\n\r\nclass ComponentStructure {\r\n  constructor({\r\n    nodes: { header, default: defaultNodes, footer },\r\n    root,\r\n    realList\r\n  }) {\r\n    this.defaultNodes = defaultNodes;\r\n    this.children = [...header, ...defaultNodes, ...footer];\r\n    this.externalComponent = root.externalComponent;\r\n    this.rootTransition = root.transition;\r\n    this.tag = root.tag;\r\n    this.realList = realList;\r\n  }\r\n\r\n  get _isRootComponent() {\r\n    return this.externalComponent || this.rootTransition;\r\n  }\r\n\r\n  render(h, attributes) {\r\n    const { tag, children, _isRootComponent } = this;\r\n    const option = !_isRootComponent ? children : { default: () => children };\r\n    return h(tag, attributes, option);\r\n  }\r\n\r\n  updated() {\r\n    const { defaultNodes, realList } = this;\r\n    defaultNodes.forEach((node, index) => {\r\n      addContext(getHtmlElementFromNode(node), {\r\n        element: realList[index],\r\n        index\r\n      });\r\n    });\r\n  }\r\n\r\n  getUnderlyingVm(domElement) {\r\n    return getContext(domElement);\r\n  }\r\n\r\n  getVmIndexFromDomIndex(domIndex, element) {\r\n    const { defaultNodes } = this;\r\n    const { length } = defaultNodes;\r\n    const domChildren = element.children;\r\n    const domElement = domChildren.item(domIndex);\r\n\r\n    if (domElement === null) {\r\n      return length;\r\n    }\r\n    const context = getContext(domElement);\r\n    if (context) {\r\n      return context.index;\r\n    }\r\n\r\n    if (length === 0) {\r\n      return 0;\r\n    }\r\n    const firstDomListElement = getHtmlElementFromNode(defaultNodes[0]);\r\n    const indexFirstDomListElement = [...domChildren].findIndex(\r\n      element => element === firstDomListElement\r\n    );\r\n    return domIndex < indexFirstDomListElement ? 0 : length;\r\n  }\r\n}\r\n\r\nexport { ComponentStructure };\r\n"],"mappings":"AAAA,MAAMA,sBAAsB,GAAG,CAAC;EAAEC;AAAG,CAAC,KAAKA,EAAE;AAC7C,MAAMC,UAAU,GAAG,CAACC,UAAU,EAAEC,OAAO,KACpCD,UAAU,CAACE,mBAAmB,GAAGD,OAAQ;AAC5C,MAAME,UAAU,GAAGH,UAAU,IAAIA,UAAU,CAACE,mBAAmB;AAE/D,MAAME,kBAAkB,CAAC;EACvBC,WAAW,CAAC;IACVC,KAAK,EAAE;MAAEC,MAAM;MAAEC,OAAO,EAAEC,YAAY;MAAEC;IAAO,CAAC;IAChDC,IAAI;IACJC;EACF,CAAC,EAAE;IACD,IAAI,CAACH,YAAY,GAAGA,YAAY;IAChC,IAAI,CAACI,QAAQ,GAAG,CAAC,GAAGN,MAAM,EAAE,GAAGE,YAAY,EAAE,GAAGC,MAAM,CAAC;IACvD,IAAI,CAACI,iBAAiB,GAAGH,IAAI,CAACG,iBAAiB;IAC/C,IAAI,CAACC,cAAc,GAAGJ,IAAI,CAACK,UAAU;IACrC,IAAI,CAACC,GAAG,GAAGN,IAAI,CAACM,GAAG;IACnB,IAAI,CAACL,QAAQ,GAAGA,QAAQ;EAC1B;EAEA,IAAIM,gBAAgB,GAAG;IACrB,OAAO,IAAI,CAACJ,iBAAiB,IAAI,IAAI,CAACC,cAAc;EACtD;EAEAI,MAAM,CAACC,CAAC,EAAEC,UAAU,EAAE;IACpB,MAAM;MAAEJ,GAAG;MAAEJ,QAAQ;MAAEK;IAAiB,CAAC,GAAG,IAAI;IAChD,MAAMI,MAAM,GAAG,CAACJ,gBAAgB,GAAGL,QAAQ,GAAG;MAAEL,OAAO,EAAE,MAAMK;IAAS,CAAC;IACzE,OAAOO,CAAC,CAACH,GAAG,EAAEI,UAAU,EAAEC,MAAM,CAAC;EACnC;EAEAC,OAAO,GAAG;IACR,MAAM;MAAEd,YAAY;MAAEG;IAAS,CAAC,GAAG,IAAI;IACvCH,YAAY,CAACe,OAAO,CAAC,CAACC,IAAI,EAAEC,KAAK,KAAK;MACpC3B,UAAU,CAACF,sBAAsB,CAAC4B,IAAI,CAAC,EAAE;QACvCE,OAAO,EAAEf,QAAQ,CAACc,KAAK,CAAC;QACxBA;MACF,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ;EAEAE,eAAe,CAAC5B,UAAU,EAAE;IAC1B,OAAOG,UAAU,CAACH,UAAU,CAAC;EAC/B;EAEA6B,sBAAsB,CAACC,QAAQ,EAAEH,OAAO,EAAE;IACxC,MAAM;MAAElB;IAAa,CAAC,GAAG,IAAI;IAC7B,MAAM;MAAEsB;IAAO,CAAC,GAAGtB,YAAY;IAC/B,MAAMuB,WAAW,GAAGL,OAAO,CAACd,QAAQ;IACpC,MAAMb,UAAU,GAAGgC,WAAW,CAACC,IAAI,CAACH,QAAQ,CAAC;IAE7C,IAAI9B,UAAU,KAAK,IAAI,EAAE;MACvB,OAAO+B,MAAM;IACf;IACA,MAAM9B,OAAO,GAAGE,UAAU,CAACH,UAAU,CAAC;IACtC,IAAIC,OAAO,EAAE;MACX,OAAOA,OAAO,CAACyB,KAAK;IACtB;IAEA,IAAIK,MAAM,KAAK,CAAC,EAAE;MAChB,OAAO,CAAC;IACV;IACA,MAAMG,mBAAmB,GAAGrC,sBAAsB,CAACY,YAAY,CAAC,CAAC,CAAC,CAAC;IACnE,MAAM0B,wBAAwB,GAAG,CAAC,GAAGH,WAAW,CAAC,CAACI,SAAS,CACzDT,OAAO,IAAIA,OAAO,KAAKO,mBAAmB,CAC3C;IACD,OAAOJ,QAAQ,GAAGK,wBAAwB,GAAG,CAAC,GAAGJ,MAAM;EACzD;AACF;AAEA,SAAS3B,kBAAkB"},"metadata":{},"sourceType":"module","externalDependencies":[]}