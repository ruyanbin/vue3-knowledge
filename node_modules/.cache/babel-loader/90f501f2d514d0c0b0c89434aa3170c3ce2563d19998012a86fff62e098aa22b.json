{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nclass PriorityQueue {\n  constructor() {\n    // options\n    this.maxJobs = 6;\n    this.items = [];\n    this.callbacks = new Map();\n    this.currJobs = 0;\n    this.scheduled = false;\n    this.autoUpdate = true;\n    this.priorityCallback = () => {\n      throw new Error('PriorityQueue: PriorityCallback function not defined.');\n    };\n\n    // Customizable scheduling callback. Default using requestAnimationFrame()\n    this.schedulingCallback = func => {\n      requestAnimationFrame(func);\n    };\n    this._runjobs = () => {\n      this.tryRunJobs();\n      this.scheduled = false;\n    };\n  }\n  sort() {\n    const priorityCallback = this.priorityCallback;\n    const items = this.items;\n    items.sort(priorityCallback);\n  }\n  add(item, callback) {\n    return new Promise((resolve, reject) => {\n      const prCallback = (...args) => callback(...args).then(resolve).catch(reject);\n      const items = this.items;\n      const callbacks = this.callbacks;\n      items.push(item);\n      callbacks.set(item, prCallback);\n      if (this.autoUpdate) {\n        this.scheduleJobRun();\n      }\n    });\n  }\n  remove(item) {\n    const items = this.items;\n    const callbacks = this.callbacks;\n    const index = items.indexOf(item);\n    if (index !== -1) {\n      items.splice(index, 1);\n      callbacks.delete(item);\n    }\n  }\n  tryRunJobs() {\n    this.sort();\n    const items = this.items;\n    const callbacks = this.callbacks;\n    const maxJobs = this.maxJobs;\n    let currJobs = this.currJobs;\n    while (maxJobs > currJobs && items.length > 0) {\n      currJobs++;\n      const item = items.pop();\n      const callback = callbacks.get(item);\n      callbacks.delete(item);\n      callback(item).then(() => {\n        this.currJobs--;\n        if (this.autoUpdate) {\n          this.scheduleJobRun();\n        }\n      }).catch(() => {\n        this.currJobs--;\n        if (this.autoUpdate) {\n          this.scheduleJobRun();\n        }\n      });\n    }\n    this.currJobs = currJobs;\n  }\n  scheduleJobRun() {\n    if (!this.scheduled) {\n      this.schedulingCallback(this._runjobs);\n      this.scheduled = true;\n    }\n  }\n}\nexport { PriorityQueue };","map":{"version":3,"names":["PriorityQueue","constructor","maxJobs","items","callbacks","Map","currJobs","scheduled","autoUpdate","priorityCallback","Error","schedulingCallback","func","requestAnimationFrame","_runjobs","tryRunJobs","sort","add","item","callback","Promise","resolve","reject","prCallback","args","then","catch","push","set","scheduleJobRun","remove","index","indexOf","splice","delete","length","pop","get"],"sources":["/Users/yanbinru/Desktop/代码/github/vue3-knowledge/node_modules/3d-tiles-renderer/src/utilities/PriorityQueue.js"],"sourcesContent":["class PriorityQueue {\n\n\tconstructor() {\n\n\t\t// options\n\t\tthis.maxJobs = 6;\n\n\t\tthis.items = [];\n\t\tthis.callbacks = new Map();\n\t\tthis.currJobs = 0;\n\t\tthis.scheduled = false;\n\t\tthis.autoUpdate = true;\n\n\t\tthis.priorityCallback = () => {\n\n\t\t\tthrow new Error( 'PriorityQueue: PriorityCallback function not defined.' );\n\n\t\t};\n\n\t\t// Customizable scheduling callback. Default using requestAnimationFrame()\n\t\tthis.schedulingCallback = func => {\n\n\t\t\trequestAnimationFrame( func );\n\n\t\t};\n\n\t\tthis._runjobs = () => {\n\n\t\t\tthis.tryRunJobs();\n\t\t\tthis.scheduled = false;\n\n\t\t};\n\n\t}\n\n\tsort() {\n\n\t\tconst priorityCallback = this.priorityCallback;\n\t\tconst items = this.items;\n\t\titems.sort( priorityCallback );\n\n\t}\n\n\tadd( item, callback ) {\n\n\t\treturn new Promise( ( resolve, reject ) => {\n\n\t\t\tconst prCallback = ( ...args ) => callback( ...args ).then( resolve ).catch( reject );\n\t\t\tconst items = this.items;\n\t\t\tconst callbacks = this.callbacks;\n\n\t\t\titems.push( item );\n\t\t\tcallbacks.set( item, prCallback );\n\n\t\t\tif ( this.autoUpdate ) {\n\n\t\t\t\tthis.scheduleJobRun();\n\n\t\t\t}\n\n\t\t} );\n\n\t}\n\n\tremove( item ) {\n\n\t\tconst items = this.items;\n\t\tconst callbacks = this.callbacks;\n\n\t\tconst index = items.indexOf( item );\n\t\tif ( index !== - 1 ) {\n\n\t\t\titems.splice( index, 1 );\n\t\t\tcallbacks.delete( item );\n\n\t\t}\n\n\t}\n\n\ttryRunJobs() {\n\n\t\tthis.sort();\n\n\t\tconst items = this.items;\n\t\tconst callbacks = this.callbacks;\n\t\tconst maxJobs = this.maxJobs;\n\t\tlet currJobs = this.currJobs;\n\t\twhile ( maxJobs > currJobs && items.length > 0 ) {\n\n\t\t\tcurrJobs ++;\n\t\t\tconst item = items.pop();\n\t\t\tconst callback = callbacks.get( item );\n\t\t\tcallbacks.delete( item );\n\t\t\tcallback( item )\n\t\t\t\t.then( () => {\n\n\t\t\t\t\tthis.currJobs --;\n\n\t\t\t\t\tif ( this.autoUpdate ) {\n\n\t\t\t\t\t\tthis.scheduleJobRun();\n\n\t\t\t\t\t}\n\n\t\t\t\t} )\n\t\t\t\t.catch( () => {\n\n\t\t\t\t\tthis.currJobs --;\n\n\t\t\t\t\tif ( this.autoUpdate ) {\n\n\t\t\t\t\t\tthis.scheduleJobRun();\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t}\n\t\tthis.currJobs = currJobs;\n\n\t}\n\n\tscheduleJobRun() {\n\n\t\tif ( ! this.scheduled ) {\n\n\t\t\tthis.schedulingCallback( this._runjobs );\n\n\t\t\tthis.scheduled = true;\n\n\t\t}\n\n\t}\n\n}\n\nexport { PriorityQueue };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}